!function(d){const n="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMCIgaGVpZ2h0PSIxMCIgdmlld0JveD0iMCAwIDEwIDEwIj48cmVjdCB3aWR0aD0iMTAiIGhlaWdodD0iMTAiIGZpbGw9Im5vbmUiLz48L3N2Zz4=";let i,s="normal",r={};function o(){let a=!1,n=0,i=0,s=0,o=0,e=document.getElementById("canvas"),c=e.getContext("2d"),l=document.getElementById("img0");e.width=l.naturalWidth,e.height=l.naturalHeight,c.drawImage(l,0,0),d("#canvas").on("mousedown",function(e){a=!0;var t=e.target.getBoundingClientRect();n=s=e.clientX-t.left,i=o=e.clientY-t.top,c.lineWidth=1,c.setLineDash([2,3])}),d("#canvas").on("mousemove",function(e){var t;a&&(t=e.target.getBoundingClientRect(),s=e.clientX-t.left,o=e.clientY-t.top,c.drawImage(l,0,0),c.beginPath(),c.moveTo(n,i),c.lineTo(s,i),c.moveTo(n,o),c.lineTo(s,o),c.moveTo(s,i),c.lineTo(s,o),c.moveTo(n,i),c.lineTo(n,o),c.stroke())}),d("#canvas").on("mouseup",function(e){var t;n===s&&i===o&&(c.drawImage(l,0,0),n=s=0,i=o=0),a&&(r.sx=Math.min(n,s),r.sy=Math.min(i,o),r.sw=Math.max(n-s,s-n),r.sh=Math.max(i-o,o-i),t="",t+="横幅："+r.sw,t+="　高さ："+r.sh,t+="　X座標："+r.sx,t+="　Y座標："+r.sy,d(".js-setting").text(t),localStorage.setItem("sx",r.sx),localStorage.setItem("sy",r.sy),localStorage.setItem("sw",r.sw),localStorage.setItem("sh",r.sh)),a=!1})}d(window).on("load",function(){!function(){let e="";localStorage.getItem("sw")&&(e+="横幅："+localStorage.sw),localStorage.getItem("sh")&&(e+="　高さ："+localStorage.sh),localStorage.getItem("sx")&&(e+="　X座標："+localStorage.sx),localStorage.getItem("sy")&&(e+="　Y座標："+localStorage.sy),d(".js-last-setting").text(e)}(),d(".c-ac:not(:first-child)").find(".js-ac-cnt").hide(),d(".c-ac:first-child").find(".js-ac-btn").addClass("is-open"),d(".js-ac-btn").on("click",function(){d(this).toggleClass("is-open").next(".js-ac-cnt").slideToggle(200)}),function(){for(let e=0;e<12;e++)d(".input-set").append('<div class="input-preview"><div class="img"><img src="'+n+'" /></div><p class="txt">'+parseInt(e+1)+"</p></div>");d('[type="file"]').on("change",function(){var t=d(this).prop("files");let a=[];switch(d(".input-preview").find("img").attr("src",n),d(".input-preview").hide(),s){case"normal":file_max=6,d(".input-preview:nth-child(-n+6)").show(),console.log(s);break;case"combined":file_max=12,d(".input-preview").show();break;case"flying_s":file_max=7,d(".input-preview:nth-child(-n+7)").show()}i=t.length,file_max<t.length&&(i=file_max);for(let e=0;e<i;e++)a[e]=new FileReader,a[e].onloadend=function(){d(".input-preview").eq(e).find("img").attr({src:a[e].result,id:"img"+e}),e+1===i&&o()},a[e].readAsDataURL(t[e])})}(),d(".input-preview").on("dragstart",function(e){e.originalEvent.dataTransfer.setData("text/plain",e.target.id)}),d(".input-preview").on("dragover",function(e){e.preventDefault()}),d(".input-preview").on("drop",function(e){e.preventDefault();var t=e.originalEvent.dataTransfer.getData("text/plain"),e=d(this).find("img").attr("src");d(this).find("img").attr("src",document.getElementById(t).src),document.getElementById(t).src=e,o()}),d("input[name=type]").on("change",function(){switch(d(this).val()){case"normal":s="normal";break;case"combined":s="combined";break;case"flying_s":s="flying_s"}}),function(){let t=[],e=document.getElementById("generate"),a=e.getContext("2d");d(".js-btn-generate").on("click",function(){switch(sx=localStorage.sx,sy=localStorage.sy,sw=localStorage.sw,sh=localStorage.sh,s){case"normal":e.width=2*sw,e.height=3*sh;break;case"combined":e.width=4*sw,e.height=3*sh;break;case"flying_s":e.width=2*sw,e.height=4*sh}a.beginPath(),a.fillStyle="rgb(234 226 211)",a.fillRect(0,0,e.width,e.height);for(let e=0;e<i;e++){switch(dx=0,dy=0,dw=sw,dh=sh,e){case 1:case 3:case 5:dx=+dw;break;case 6:case 8:case 10:dx=2*dw;break;case 7:case 9:case 11:dx=3*dw}switch(e){case 2:case 3:case 8:case 9:dy=+dh;break;case 4:case 5:case 10:case 11:dy=2*dh}"flying_s"===s&&6===e&&(dx=0,dy=3*dh),t[e]=document.getElementById("img"+e),a.drawImage(t[e],sx,sy,sw,sh,dx,dy,dw,dh)}})}()})}(jQuery);